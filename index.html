<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
      body { font-family: 'Helvetica Neue', Arial, sans-serif; padding: 20px; line-height: 1.6; color: #333; }
      #result { background: #f9f9f9; padding: 20px; border-radius: 8px; border: 1px solid #ddd; margin-top: 20px; }
      /* Markdown表示用のスタイル調整 */
      #result ul, #result ol { padding-left: 20px; }
      #result code { background: #eee; padding: 2px 4px; border-radius: 4px; }
      #result p { margin-bottom: 1em; }
    </style>
  </head>
  <body>
    <h2>英日・日英翻訳</h2>
    <input type="radio" id="transtype1" name="transtype" value="日本語を英語に">日本語を英語に
    <input type="radio" id="transtype2" name="transtype" value="英語を日本語に" checked>英語を日本語に<br>
    <input type="text" id="searchTerm" style="width: 300px; padding: 5px;"><br><br>
    
    <button onclick="lookup()" style="padding: 5px 15px; cursor: pointer;">翻訳</button>

    <div id="result">結果がここに表示されます...</div>

    <script>
      function lookup() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerText = "Geminiが考え中...";

        const trans_direction = document.querySelector('input[name="transtype"]:checked');
        var prompt = "次の" + trans_direction.value + 
          "翻訳してください。単語としての意味が複数ある場合は、それらを箇条書きにして、同時にその意味の用例も示してください。\n" +
          "翻訳する単語：" + document.getElementById("searchTerm").value;

        google.script.run
          .withSuccessHandler(res => { 
            // MarkdownをHTMLに変換して表示
            resultDiv.innerHTML = marked.parse(res); 
          })
          .withFailureHandler(err => { 
            resultDiv.innerText = "エラー: " + err; 
          })
          .submitQuery(prompt);
      }
    </script>
  </body>
</html>
